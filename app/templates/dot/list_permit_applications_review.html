<thead class="table-dark">
    <tr>
        <th>App ID</th>
        <th>Applicant</th>
        <th>Vehicle Type</th>
        <th>Travel Dates</th>
        <th>Application Date</th>
        <th>Status</th>
        <th>Fee Set</th>
        <th>Actions</th>
    </tr>
</thead>
<tbody>
    {% for app in applications_pagination.items %}
    <tr>
        <td>{{ app.id }}</td>
        <td>{{ app.applicant.username }}</td>
        <td>{{ app.vehicle_type|truncate(30, True) }}</td>
        <td>{{ app.travel_start_date.strftime('%Y-%m-%d') }} to {{ app.travel_end_date.strftime('%Y-%m-%d') }}</td>
        <td>{{ app.application_date.strftime('%Y-%m-%d %H:%M') }}</td>
        <td>
            <span class="badge bg-{{
                'primary' if app.status == PermitApplicationStatus.PENDING_REVIEW
                else 'info' if app.status == PermitApplicationStatus.REQUIRES_MODIFICATION
                else 'warning' if app.status == PermitApplicationStatus.APPROVED_PENDING_PAYMENT
                else 'secondary' if app.status == PermitApplicationStatus.PAID_AWAITING_ISSUANCE
                else 'success' if app.status == PermitApplicationStatus.ISSUED
                else 'danger' if app.status == PermitApplicationStatus.REJECTED
                else 'dark' }}">
                {{ app.status.value }}
            </span>
        </td>
        <td>{{ "%.2f"|format(app.permit_fee) if app.permit_fee else 'N/A' }}</td>
        <td>
            <a href="{{ url_for('dot.view_permit_application_detail', application_id=app.id) }}" class="btn btn-sm btn-info">View Details</a>
            {% if app.status in [PermitApplicationStatus.PENDING_REVIEW, PermitApplicationStatus.REQUIRES_MODIFICATION] %}
                <a href="{{ url_for('dot.process_permit_application', application_id=app.id) }}" class="btn btn-sm btn-primary">Process</a>
            {% elif app.status == PermitApplicationStatus.PAID_AWAITING_ISSUANCE %}
                <form method="POST" action="{{ url_for('dot.issue_final_permit', application_id=app.id) }}" style="display:inline;" onsubmit="return confirm('Confirm issuance of this permit?');">
                    <input type="submit" value="Issue Permit" class="btn btn-sm btn-success">
                </form>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</tbody>
