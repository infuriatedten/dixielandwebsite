{% extends "base.html" %}

{% block title %}Permit Applications{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1>Permit Applications</h1>

    {% if permits %}
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>ID</th>
            <th>User ID</th>
            <th>Vehicle Type</th>
            <th>Route Details</th>
            <th>Travel Start</th>
            <th>Travel End</th>
            <th>Status</th>
            <th>Created At</th>
            <th>Permit Fee</th>
            <th>Officer Notes</th>
            <th>Issued Permit ID</th>
            <th>Issued On</th>
          </tr>
        </thead>
        <tbody>
          {% for permit in permits %}
          <tr>
            <td>{{ permit.id }}</td>
            <td>{{ permit.user_id }}</td>
            <td>{{ permit.vehicle_type }}</td>
            <td>{{ permit.route_details }}</td>
            <td>{{ permit.travel_start_date.strftime('%Y-%m-%d') if permit.travel_start_date else '' }}</td>
            <td>{{ permit.travel_end_date.strftime('%Y-%m-%d') if permit.travel_end_date else '' }}</td>
            <td>
              <span class="badge 
                {% if permit.status.value == 'Approved' %}bg-success
                {% elif permit.status.value == 'Pending' %}bg-warning text-dark
                {% elif permit.status.value == 'Denied' %}bg-danger
                {% else %}bg-secondary{% endif %}">
                {{ permit.status.value }}
              </span>
            </td>
            <td>{{ permit.created_at.strftime('%Y-%m-%d %H:%M:%S') if permit.created_at else '' }}</td>
            <td>{{ permit.permit_fee if permit.permit_fee else 'N/A' }}</td>
            <td>{{ permit.officer_notes or '' }}</td>
            <td>{{ permit.issued_permit_id_str or '' }}</td>
            <td>{{ permit.issued_on_date.strftime('%Y-%m-%d') if permit.issued_on_date else '' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <p>No permit applications found.</p>
    {% endif %}
</div>
{% endblock %}
